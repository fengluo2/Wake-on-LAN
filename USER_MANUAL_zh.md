# Wake on LAN 操作手册

## 目录
1. [简介](#简介)
2. [安装](#安装)
3. [快速入门](#快速入门)
4. [功能详解](#功能详解)
5. [常见问题](#常见问题)
6. [故障排除](#故障排除)

---

## 简介

Wake on LAN 是一个轻量级的 Android 应用程序，用于通过网络远程唤醒支持 Wake-on-LAN (WoL) 功能的设备。该应用支持两种唤醒模式：
- **直连模式**：在同一局域网内直接发送 WoL 魔术包
- **代理模式**：通过 SSH 代理服务器发送 WoL 魔术包（支持 OpenWrt 和 Ubuntu）

### 系统要求
- Android 设备
- 目标设备需要支持并启用 Wake-on-LAN 功能
- 对于代理模式：需要一台运行 OpenWrt 或 Ubuntu 的代理服务器

---

## 安装

### 方法 1：下载 APK
1. 访问 [Releases 页面](https://github.com/fengluo2/Wake-on-LAN/releases)
2. 下载最新版本的 APK 文件
3. 在 Android 设备上安装 APK
   - 注意：首次安装需要在设置中允许"未知来源"应用安装

### 方法 2：从源码编译
1. 克隆仓库：
   ```bash
   git clone https://github.com/fengluo2/Wake-on-LAN.git
   ```
2. 使用 Android Studio 打开项目
3. 编译并安装到设备

---

## 快速入门

### 第一步：启动应用
打开 Wake on LAN 应用，您将看到设备列表页面（初次使用时列表为空）。

### 第二步：添加设备

#### 添加直连设备（推荐用于局域网内设备）
1. 点击右下角的 **"增加连接"** 按钮（+ 图标）
2. 填写设备信息：
   - **名字**：为设备起一个便于识别的名称（如：我的电脑、客厅电视）
   - **连接类型**：选择 "直连"
   - **主机IP**：目标设备的 IP 地址（如：192.168.1.100）
   - **主机MAC**：目标设备的 MAC 地址（格式：00:11:22:33:44:55）
   - **备注**（可选）：添加备注信息
3. 点击 **"保存连接"** 按钮

#### 添加代理设备（用于远程唤醒）
1. 点击右下角的 **"增加连接"** 按钮（+ 图标）
2. 填写设备信息：
   - **名字**：为设备起一个便于识别的名称
   - **连接类型**：选择 "代理"
   - **代理主机地址**：代理服务器的 IP 地址或域名
   - **代理主机端口**：SSH 端口（默认 22）
   - **代理登录类型**：选择 "密码" 或 "密钥"
   - **代理登录用户**：SSH 登录用户名（通常为 root）
   - **代理登录密码/私钥**：根据登录类型填写相应信息
   - **主机IP**：目标设备的 IP 地址
   - **主机MAC**：目标设备的 MAC 地址
   - **备注**（可选）：添加备注信息
3. 点击 **"保存连接"** 按钮

### 第三步：唤醒设备
1. 在设备列表中找到要唤醒的设备
2. 点击设备条目右侧的 **"发送 Wol 包"** 按钮
3. 应用将发送 WoL 魔术包，并显示发送结果

---

## 功能详解

### 1. 设备管理

#### 查看设备列表
- 主界面显示所有已添加的设备
- 每个设备显示名称、类型（直连/代理）和备注信息

#### 编辑设备
1. 在设备列表中，点击设备条目的 **"编辑"** 按钮（铅笔图标）
2. 修改设备信息
3. 点击 **"保存连接"** 保存更改

#### 删除设备
- **删除单个设备**：点击设备条目的 **"删除"** 按钮（垃圾桶图标）
- **删除所有设备**：点击右上角菜单 → 选择 **"删除所有"**

### 2. 发送 WoL 包

#### 直连模式发送
- 应用通过 Wi-Fi 或移动网络直接向目标设备发送 UDP 魔术包
- 发送端口：通常为 UDP 9 端口
- 适用场景：设备与手机在同一局域网内

#### 代理模式发送
- 应用通过 SSH 连接到代理服务器
- 在代理服务器上执行 `wakeonlan` 命令发送魔术包
- 适用场景：
  - 远程唤醒不在同一网络的设备
  - 目标网络有防火墙限制
  - 需要通过特定网关发送 WoL 包

### 3. 数据导入导出

#### 导出设备列表
1. 点击右上角菜单（三个点）
2. 选择 **"导出"**
3. 应用将设备列表导出为 JSON 文件
4. 文件保存位置会在导出成功后显示

#### 导入设备列表
1. 点击右上角菜单（三个点）
2. 选择 **"导入"**
3. 选择之前导出的 JSON 文件
4. 设备列表将被导入到应用中

### 4. 其他功能

#### 查看开源许可证
- 点击右上角菜单 → 选择 **"许可证"**
- 查看应用使用的开源组件许可证信息

#### 关于
- 点击右上角菜单 → 选择 **"关于"**
- 查看应用版本和相关信息

---

## 常见问题

### Q1: 如何获取设备的 MAC 地址？

**Windows：**
1. 打开命令提示符（CMD）
2. 输入 `ipconfig /all`
3. 找到网卡的"物理地址"即为 MAC 地址

**Linux/macOS：**
1. 打开终端
2. 输入 `ifconfig` 或 `ip link show`
3. 找到网卡的 MAC 地址（ether 或 HWaddr）

**路由器管理界面：**
- 登录路由器管理界面
- 查看已连接设备列表，可以看到所有设备的 MAC 地址

### Q2: 设备需要做哪些设置才能被唤醒？

1. **BIOS/UEFI 设置：**
   - 进入 BIOS/UEFI 设置
   - 启用 "Wake on LAN"、"PME Event Wake Up" 或类似选项
   - 启用 "Power On by PCI-E/PCI" 选项

2. **操作系统设置（Windows）：**
   - 打开"设备管理器"
   - 找到网络适配器，右键选择"属性"
   - 在"电源管理"选项卡中，勾选"允许此设备唤醒计算机"
   - 在"高级"选项卡中，启用 Wake on LAN 相关选项

3. **操作系统设置（Linux）：**
   ```bash
   # 检查 WoL 状态
   sudo ethtool eth0 | grep Wake-on
   
   # 启用 WoL
   sudo ethtool -s eth0 wol g
   ```

4. **电源设置：**
   - 确保设备处于关机或睡眠状态（不是完全断电）
   - 网线必须保持连接
   - 电源供应必须保持连接

### Q3: 代理模式如何配置代理服务器？

#### OpenWrt 系统：
1. SSH 连接到 OpenWrt 路由器
2. 安装 wakeonlan 工具：
   ```bash
   opkg update
   opkg install wakeonlan
   ```
3. 确认安装：
   ```bash
   opkg list-installed | grep wakeonlan
   ```

#### Ubuntu/Debian 系统：
1. SSH 连接到服务器
2. 安装 wakeonlan 工具：
   ```bash
   sudo apt update
   sudo apt install wakeonlan
   ```
3. 确认安装：
   ```bash
   dpkg -l | grep wakeonlan
   ```

#### SSH 认证配置：
- **密码认证**：直接使用 SSH 用户密码
- **密钥认证**：使用 SSH 私钥（推荐，更安全）
  - 将私钥内容粘贴到"代理登录私钥"字段
  - 私钥格式通常为 PEM 格式

### Q4: 为什么无法唤醒设备？

请依次检查以下项：

1. **设备是否支持 WoL：**
   - 不是所有设备都支持 Wake-on-LAN
   - 某些笔记本电脑在使用电池供电时不支持 WoL

2. **网络连接：**
   - 目标设备的网线必须连接
   - 路由器或交换机必须开启
   - 对于直连模式，确保手机和目标设备在同一网络

3. **MAC 地址和 IP 地址：**
   - 确认 MAC 地址格式正确（使用冒号分隔，如：00:11:22:33:44:55）
   - 确认 IP 地址正确

4. **防火墙：**
   - 某些路由器或防火墙可能阻止 WoL 包
   - 尝试在路由器中允许 UDP 9 端口

5. **代理模式特定问题：**
   - 确认代理服务器已安装 wakeonlan 工具
   - 确认 SSH 连接信息（地址、端口、用户名、密码/密钥）正确
   - 确认代理服务器与目标设备在同一网络

---

## 故障排除

### 问题：发送 WoL 包失败

**可能原因及解决方法：**

1. **网络权限不足：**
   - 检查应用是否被授予网络权限
   - 在 Android 设置中：应用 → Wake on LAN → 权限 → 确保已授予必要权限

2. **Wi-Fi 未连接（直连模式）：**
   - 确保设备已连接到 Wi-Fi 网络
   - 移动数据网络可能无法发送 WoL 包到局域网设备

3. **代理服务器连接失败（代理模式）：**
   - 检查代理服务器地址和端口
   - 检查 SSH 用户名和密码/密钥
   - 确认代理服务器可以从互联网访问（如果远程使用）
   - 检查防火墙是否阻止了 SSH 连接

### 问题：导入失败

**可能原因及解决方法：**

1. **文件格式错误：**
   - 确保导入的是通过本应用导出的 JSON 文件
   - 不要手动修改导出的 JSON 文件

2. **文件读取权限：**
   - 检查应用是否被授予存储权限
   - 在 Android 设置中授予必要的文件访问权限

### 问题：不支持的系统类型

**说明：**
- 代理模式目前仅支持 OpenWrt 和 Ubuntu 系统
- 如果需要支持其他系统，请在 GitHub 提交 Issue

**可能的解决方案：**
1. 在其他 Linux 发行版上手动安装 wakeonlan 工具
2. 修改系统使其兼容 apt 或 opkg 包管理器
3. 向项目提交功能请求以支持更多系统

### 问题：应用闪退或异常

**建议操作：**
1. 确保使用最新版本的应用
2. 清除应用缓存和数据（注意：会清除所有已保存的设备，请先导出）
3. 重新安装应用
4. 在 GitHub 上提交 Bug 报告，包含：
   - Android 版本
   - 设备型号
   - 详细的复现步骤
   - 错误信息（如果有）

---

## 技术说明

### WoL 魔术包格式
Wake-on-LAN 魔术包是一个包含以下内容的 UDP 数据包：
- 6 个字节的 0xFF
- 目标设备 MAC 地址重复 16 次

### 直连模式工作原理
1. 应用构造 WoL 魔术包
2. 通过 UDP 广播发送到网络（默认端口 9 或 7）
3. 目标设备的网卡接收到魔术包后唤醒系统

### 代理模式工作原理
1. 应用通过 SSH 连接到代理服务器
2. 在代理服务器上执行 wakeonlan 命令
3. 代理服务器发送 WoL 魔术包到目标设备
4. 目标设备被唤醒

---

## 支持与反馈

如果您在使用过程中遇到问题或有改进建议，欢迎：
- 在 GitHub 上提交 [Issue](https://github.com/fengluo2/Wake-on-LAN/issues)
- 贡献代码：提交 [Pull Request](https://github.com/fengluo2/Wake-on-LAN/pulls)

---

## 许可证

本项目采用开源许可证，详见 [LICENSE.md](LICENSE.md) 文件。

---

**最后更新：2025年11月**
